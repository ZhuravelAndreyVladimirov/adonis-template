# API Авторизации и Регистрации

Этот документ описывает API для авторизации и регистрации пользователей в Adonis.js приложении.

## Маршруты

### 1. Регистрация пользователя
- **URL:** `POST /auth/register`
- **Описание:** Создает нового пользователя и автоматически авторизует его
- **Тело запроса:**
  ```json
  {
    "email": "user@example.com",
    "password": "password123",
    "fullName": "Имя Пользователя"
  }
  ```
- **Ответ (201):**
  ```json
  {
    "message": "Пользователь успешно зарегистрирован",
    "user": {
      "id": 1,
      "email": "user@example.com",
      "fullName": "Имя Пользователя"
    }
  }
  ```

### 2. Авторизация пользователя
- **URL:** `POST /auth/login`
- **Описание:** Авторизует существующего пользователя
- **Тело запроса:**
  ```json
  {
    "email": "user@example.com",
    "password": "password123"
  }
  ```
- **Ответ (200):**
  ```json
  {
    "message": "Успешная авторизация",
    "user": {
      "id": 1,
      "email": "user@example.com",
      "fullName": "Имя Пользователя"
    }
  }
  ```

### 3. Получение информации о пользователе
- **URL:** `GET /auth/me`
- **Описание:** Возвращает информацию о текущем авторизованном пользователе
- **Требует авторизацию:** Да
- **Ответ (200):**
  ```json
  {
    "user": {
      "id": 1,
      "email": "user@example.com",
      "fullName": "Имя Пользователя",
      "createdAt": "2024-01-15T10:30:00.000Z"
    }
  }
  ```

### 4. Выход из системы
- **URL:** `POST /auth/logout`
- **Описание:** Завершает сессию пользователя
- **Требует авторизацию:** Да
- **Ответ (200):**
  ```json
  {
    "message": "Успешный выход из системы"
  }
  ```

## Валидация

### Регистрация
- `email`: обязательное поле, должно быть валидным email
- `password`: обязательное поле, минимум 8 символов
- `fullName`: необязательное поле

### Авторизация
- `email`: обязательное поле, должно быть валидным email
- `password`: обязательное поле

## Безопасность

- Пароли хешируются с использованием scrypt
- Сессии управляются через cookies
- Все защищенные маршруты требуют авторизации
- Валидация входных данных предотвращает SQL-инъекции

## Обработка ошибок

### Ошибки валидации (400)
```json
{
  "error": "Ошибка валидации данных",
  "details": "Детали ошибки валидации"
}
```

### Ошибки авторизации (401)
```json
{
  "error": "Неверный email или пароль"
}
```

### Ошибки сервера (500)
```json
{
  "error": "Описание ошибки"
}
```

## Тестирование

Для тестирования API используйте файл `test_auth.http` с расширением REST Client в VS Code или аналогичным инструментом.

## Запуск

1. Убедитесь, что база данных настроена и миграции выполнены
2. Запустите сервер: `npm run dev`
3. API будет доступно по адресу: `http://localhost:3333`
